if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,r){for(var e in r)__hasProp.call(r,e)&&(t[e]=r[e]);function n(){this.constructor=t}return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t};define(["./service"],function(t){var r,e;return{QueryService:r=function(t){function r(t,e){this.$rootScope=t,this.$http=e,r.__super__.constructor.apply(this,arguments)}return __extends(r,t),r.prototype.onSuccess=function(t,r,e){var n,o,i,u;return this.$rootScope.loading=!1,(n=null!=(i=t.data)?i:{})._err?(o=null!=(u=n._err.message)?u:n._err,"function"==typeof r?r(o):void 0):e||"string"==typeof n?"function"==typeof r?r(null,n):void 0:"function"==typeof r?r(null,n.data,n.paging):void 0},r.prototype.onError=function(t,r,e){var n,o,i,u;return this.$rootScope.loading=!1,o=(null!=(n=null!=(i=t.data)?i:{})?n._err:void 0)?null!=(u=n._err.message)?u:n._err:"error: "+t.status,"function"==typeof r?r(o,n):void 0},r.prototype.beforeAction=function(){return this.$rootScope.loading=!0},r.prototype.query=function(t,r,e,n){var o,i;return t=this.replaceUrlParam(t,null!=(o=r.filter)?o:{}),r=this.appendToken(r),this.beforeAction(),this.$http.get(t,{params:r}).then((i=this,function(t){return i.onSuccess(t,e,n)})).catch(function(t){return function(r){return t.onError(r,e,n)}}(this))},r.prototype.replaceUrlParam=function(t,r,e){var n;return"+"===(n=t.replace(/\/:([^\/\s]*)/g,function(t,n){var o,i;return i=r[n],e||delete r[n],o=null!=i?"/"+i:"/+"}))[n.length-1]&&(n=n.substr(0,n.length-2)),n},r}(t.Service)}});