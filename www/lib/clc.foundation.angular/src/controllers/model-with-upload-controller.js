if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,o){for(var e in o)__hasProp.call(o,e)&&(t[e]=o[e]);function n(){this.constructor=t}return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t};define(["./model-controller"],function(t){var o,e;return{ModelWithUploadController:o=function(t){function o(t,e,n,r,i,u,p,l,s){var a;this.uploadService=l,o.__super__.constructor.call(this,t,e,n,r,i,u,p,s),null==(a=this.options).uploadUrl&&(a.uploadUrl=this.setting.urls.uploadUrl)}return __extends(o,t),o.prototype.upload=function(){return t=this,function(o){return t.uploadImage(o)};var t},o.prototype.uploadImage=function(t){var o,e,n;if(t.files.length>0)return o=t.files[0],e=this.options.uploadUrl+"/"+o.name,this.uploadService.upload(o,e,(n=this,function(t,o){return n.$rootScope.err=t,n.current.image=o}))},o.prototype.uploadBase64=function(t,o){var e;return e=this.toBlob(t),this.uploadBlob(e,o)},o.prototype.uploadBlob=function(t,o){var e,n,r,i;return e=t,n="test",r=this.options.uploadUrl+"/test",this.uploadService.upload(e,"test",r,(i=this,function(t,e){return"function"==typeof o?o(t,e):void 0}))},o.prototype.toBase64=function(t,o){var e;return(e=new XMLHttpRequest).responseType="blob",e.onload=function(){var t;return(t=new FileReader).onloadend=function(){return"function"==typeof o?o(null,t.result):void 0},0===e.status?t.readAsDataURL(e.response):"function"==typeof o?o(e.status):void 0},e.open("GET",t),e.send()},o.prototype.toBlob=function(t){var o,e,n,r;for(o=void 0,o=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]),r=t.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(o.length),e=0;e<o.length;)n[e]=o.charCodeAt(e),e++;return new Blob([n],{type:r})},o}(t.ModelController)}});