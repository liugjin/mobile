if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,e){for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};define(["../view-model","./equipments"],function(t,e){var n,i;return{Station:n=function(t){function n(t,i){n.__super__.constructor.call(this,t,i),this.stations=[],this.stationKeys={},this.stationIds=[i.station],this.project=this.parent.parent,this.equipments=new e.Equipments(this),this.signals={},this.events={},this.commands={},this.ports={},this.statistic={alarms:0,capacity:0,pue:0,equipments:0,stockItems:0,connections:0}}return __extends(n,t),n.prototype.getIds=function(){var t;return(t=this.project.getIds()).station=this.model.station,t},n.prototype.appendStation=function(t){return this.stations.push(t),this.stationKeys[t.model.station]=t,this.stationIds.push(t.model.station)},n.prototype.containsStation=function(t){return this.model.station===t||this.stationKeys.hasOwnProperty(t)},n.prototype.loadEquipments=function(t,e,n,i){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),null==t.station&&(t.station=this.model.station),this.equipments.load(t,e,(s=this,function(t,e){var i,o,r;if(e)for(o=0,r=e.length;o<r;o++)i=e[o],s.project.addEquipment(i);return"function"==typeof n?n(t,e):void 0}),i);var s},n.prototype.loadEquipment=function(t,e,n,i){var s,o;return s={equipment:t,user:this.model.user,project:this.model.project,station:this.model.station},this.equipments.loadOne(s,e,(o=this,function(t,e){return e&&o.project.addEquipment(e),"function"==typeof n?n(t,e):void 0}),i)},n.prototype.dispose=function(){n.__super__.dispose.apply(this,arguments),this.equipments.dispose(),this.signals={},this.events={},this.commands={},this.ports={}},n.prototype.loadStatisticByEquipmentTypes=function(t,e){var n,i,s,o;return s="inventory/statistic-by-equipment-types/:user/:project/:station",i={user:this.model.user,project:this.model.project,station:this.model.station},n=null,this.engine.query(s,i,null,(o=this,function(e,n){return"function"==typeof t?t(e,n):void 0}),e)},n.prototype.createEquipment=function(t,e){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),null==t.station&&(t.station=this.model.station),null==t.enable&&(t.enable=!0),null==t.parent&&(t.parent=null!=e?e.model.equipment:void 0),this.equipment=this.equipments.createItem(t),this.equipment.parentEquipment=e,this.equipment},n.prototype.getEquipmentsByType=function(t){var e,n;return function(){var n,i,s,o;for(o=[],n=0,i=(s=this.equipments.items).length;n<i;n++)(e=s[n]).model.type===t&&o.push(e);return o}.call(this)},n.prototype.getFirstEquipmentByType=function(t){var e,n,i,s;for(n=0,i=(s=this.equipments.items).length;n<i;n++)if((e=s[n]).model.type===t)return e;return null},n}(t.ViewModel)}});