if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,e){for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};define(["../view-model","../items-model","./equipment-templates","./stations","./equipment-types"],function(t,e,o,s,i){var n,p;return{Project:n=function(t){function n(t,e){n.__super__.constructor.call(this,t,e),this.equipmentTemplates=new o.EquipmentTemplates(this),this.stations=new s.Stations(this),this.equipments={},this.signals={},this.signalTopics={},this.statisticTopics={},this.events={},this.eventTopics={},this.commands={},this.commandTopics={},this.ports={},this.loadModels()}return __extends(n,t),n.prototype.loadModels=function(){return this.dictionary=this.typeModels={},this.createTypeModel("datatypes","type"),this.createTypeModel("stationtypes","type"),this.createTypeModel("signaltypes","type"),this.createTypeModel("eventtypes","type"),this.createTypeModel("eventseverities","severity"),this.createTypeModel("eventphases","phase"),this.createTypeModel("units","unit"),this.createTypeModel("vendors","vendor"),this.createTypeModel("capacities","capacity"),this.createTypeModel("porttypes","type"),this.createTypeModel("equipmenttypes","type",i.EquipmentTypes)},n.prototype.getIds=function(){var t;return{user:this.model.user,project:this.model.project}},n.prototype.createTypeModel=function(t,o,s){var i;return null==s&&(s=e.ItemsModel),i=new s(this,{id:t,keys:[o]}),this.typeModels[t]=i,i},n.prototype.loadTypeModel=function(t,e,o,s){var i,n;if(n=this.typeModels[t])return i={user:this.model.user,project:this.model.project},n.load(i,e,o,s);"function"==typeof o&&o("unknown type: "+t)},n.prototype.loadTypeModels=function(t,e){var o,s,i,n;for(s in o={user:this.model.user,project:this.model.project},n=this.typeModels)(i=n[s]).load(o,null,t,e)},n.prototype.getTypeProperty=function(t,e,o){var s,i;return null!=(s=this.typeModels[t])&&null!=(i=s.getItem(e))?i.model[o]:void 0},n.prototype.loadStations=function(t,e,o){var s;return s={user:this.model.user,project:this.model.project},this.stations.load(s,t,e,o)},n.prototype.loadEquipmentTemplates=function(t,e,o,s){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),this.equipmentTemplates.load(t,e,o,s)},n.prototype.loadEquipmentTemplate=function(t,e,o,s){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),this.equipmentTemplates.loadEquipmentTemplate(t,e,o,s)},n.prototype.dispose=function(){var t,e,o;for(t in n.__super__.dispose.apply(this,arguments),o=this.typeModels)(e=o[t]).dispose();this.equipmentTemplates.dispose(),this.stations.dispose(),this.signals={},this.events={},this.commands={},this.ports={}},n.prototype.addEquipment=function(t){return this.equipments[t.key]=t},n.prototype.getEquipment=function(t){return this.equipments[t]},n.prototype.getEquipmentByIds=function(t){var e,o;if(o=this.stations.getItemByIds(t))return o.equipments.getItemByIds(t)},n.prototype.addSignal=function(t){var e,o,s;return o="signal-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.signal,this.signalTopics[o]=t,s="signal-statistics/"+e.user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.signal,this.statisticTopics[s]=t,this.signals[t.key]=t,t},n.prototype.getSignal=function(t){return this.signals[t]},n.prototype.getSignalByTopic=function(t){return this.signalTopics[t]},n.prototype.getSignalByStatisticTopic=function(t){return this.statisticTopics[t]},n.prototype.addEvent=function(t){var e,o;return o="event-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.event,this.eventTopics[o]=t,this.events[t.key]=t,t},n.prototype.getEvent=function(t){return this.events[t]},n.prototype.getEventByTopic=function(t){return this.eventTopics[t]},n.prototype.addCommand=function(t){var e,o;return o="command-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.command,this.commandTopics[o]=t,this.commands[t.key]=t,t},n.prototype.getCommand=function(t){return this.commands[t]},n.prototype.getCommandByTopic=function(t){return this.commandTopics[t]},n.prototype.addPort=function(t){return this.ports[t.key]=t},n.prototype.getPort=function(t){return this.ports[t]},n.prototype.createStation=function(t){var e;return e={user:this.model.user,project:this.model.project,parent:null!=t?t.model.station:void 0},this.station=this.stations.createItem(e),this.station.parentStation=t,this.station.root=this,this.station},n}(t.ViewModel)}});