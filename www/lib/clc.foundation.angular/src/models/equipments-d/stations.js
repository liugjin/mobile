if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,o){for(var e in o)__hasProp.call(o,e)&&(t[e]=o[e]);function n(){this.constructor=t}return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t};define(["./items-model","./station"],function(t,o){var e,n;return{Stations:e=function(t){function e(t,o){var n,r;e.__super__.constructor.call(this,t,o),null==(n=this.options).id&&(n.id="stations"),null==(r=this.options).keys&&(r.keys=["user","project","station"]),this.roots=[]}return __extends(e,t),e.prototype.createItem=function(t){var e;return new o.Station(this,t)},e.prototype.load=function(t,o,n,r){return e.__super__.load.call(this,t,o,(i=this,function(t,o){return i.processStations(o),"function"==typeof n?n(t,o):void 0}),r);var i},e.prototype.processStations=function(t){var o,e,n,r,i;if(t){for(o=function(e,n){var r,i,s,a;for(e.root=n,e.stations.length=0,r=e.model.station,s=0,a=t.length;s<a;s++)(i=t[s]).model.parent===r&&(i.parentStation=e,e.appendStation(i),o(i,n));return e},this.roots.length=0,r=0,i=t.length;r<i;r++)(e=t[r]).model.parent||(n=o(e,e),this.roots.push(n));return this.roots}},e.prototype.addNewItem=function(t){var o,n;return(n=(o=e.__super__.addNewItem.call(this,t)).parentStation)?(o.root=n.root,n.appendStation(o)):this.roots.push(o),o},e.prototype.removeItem=function(t){var o,n;if(o=e.__super__.removeItem.call(this,t))return(n=o.parentStation)?n.stations.splice(n.stations.indexOf(o),1):this.roots.splice(this.roots.indexOf(o),1),o},e}(t.ItemsModel)}});