if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(e,t){for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);function o(){this.constructor=e}return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e};define(["./equipment-model","./servers","./pdus"],function(e,t,r){var o,n;return{Rack:o=function(e){function o(e,n){o.__super__.constructor.call(this,e,n),this.servers=new t.Servers(this),this.pdus=new r.Pdus(this)}return __extends(o,e),o.prototype.loadMe=function(e,t,r){var o,n,s,i;return n={user:(s=this.parent.model).user,project:s.project,station:s.station,equipment:e},o=null,this.load(n,null,(i=this,function(e,o){return i.loadProperties(null,null,r),i.loadServers(null,null,r),i.loadPdus(null,null,r),"function"==typeof t?t(e,o):void 0}),r)},o.prototype.loadServers=function(e,t,r){var o,n,s;return o={user:(n=this.model).user,project:n.project,station:n.station,type:"server",parent:n.equipment},this.servers.load(o,e,(s=this,function(e,r){var o,n,s;for(n=0,s=r.length;n<s;n++)(o=r[n]).loadProperties();return"function"==typeof t?t(e,r):void 0}),r)},o.prototype.addServer=function(e){return this.servers.appendItem(e)},o.prototype.removeServer=function(e){return this.servers.removeItem(e,!1)},o.prototype.dispose=function(e){return o.__super__.dispose.call(this,e),this.servers.dispose(e)},o.prototype.updateModel=function(e){return"rack"===e.type?this.setModel(e):"server"===e.type?this.updateServerModel(e):void 0},o.prototype.updateServerModel=function(e){var t;return(t=this.servers.getItemByIds(e))?e.parent===this.model.equipment?t.setModel(e):this.servers.removeItem(t.key,!1):e.parent===this.model.equipment&&(t=this.servers.addItem(e)).loadProperties(),t},o.prototype.loadPdus=function(e,t,r){var o,n,s;return o={user:(n=this.model).user,project:n.project,station:n.station,type:"pdu",parent:n.equipment},this.pdus.load(o,e,(s=this,function(e,r){var o,n,s;for(n=0,s=r.length;n<s;n++)(o=r[n]).loadProperties(),o.loadPorts();return"function"==typeof t?t(e,r):void 0}),r)},o}(e.EquipmentModel)}});