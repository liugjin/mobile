if("function"!=typeof define)var define=require("amdefine")(item);var __bind=function(e,t){return function(){return e.apply(t,arguments)}};define([],function(){var e,t,i;return e="_all",{StructureModel:t=function(){function e(e,t){this.key=e,this.parentKey=t,this.selectItems=__bind(this.selectItems,this),this.buildItemTree=__bind(this.buildItemTree,this),this.items=[],this.keys={},this.model=[]}return e.prototype.setItems=function(e){var t,i,s;for(null==e&&(e=[]),this.keys={},this.model=e,i=0,s=e.length;i<s;i++)t=e[i],this.keys[t[this.key]]=t;return this.parentKey?this.buildItemTree(e):this.items=this.model,this.selectItems(e),this.items},e.prototype.buildItemTree=function(e,t){var i,s,l,h,n,r;if(t){if(s=t[this.key],this.keys[s])return;for(this.keys[s]=t,null==t.items&&(t.items=[]),l=0,n=e.length;l<n;l++)(i=e[l])[this.parentKey]===s&&(t.items.push(i),this.buildItemTree(e,i))}else for(this.items=[],h=0,r=e.length;h<r;h++)(i=e[h])[this.parentKey]||(this.items.push(i),this.buildItemTree(e,i));return this.items},e.prototype.selectItems=function(e){var t,i,s,l,h,n,r,o,u,m;if(null!=e?e.length:void 0){for("_all"===e[0]?this.all=!0:this.all=!1,t={},l=0,r=e.length;l<r;l++)t[i=e[l]]=i;for(h=0,o=(m=this.model).length;h<o;h++)(i=m[h])._selected=!!t[i[this.key]]}else for(this.all=!1,s=0,n=(u=this.model).length;s<n;s++)(i=u[s])._selected=!1},e.prototype.toggleItems=function(){var e,t,i,s;for(t=0,i=(s=this.model).length;t<i;t++)(e=s[t])._selected=!e._selected},e.prototype.selectItem=function(e){var t,i,s,l;if(e.items)for(i=0,s=(l=e.items).length;i<s;i++)(t=l[i])._selected=e._selected,this.selectItem(t)},e.prototype.getSelectedItems=function(){var e,t,i,s,l;if(e=[],this.all)e.push("_all");else if(this.model)for(i=0,s=(l=this.model).length;i<s;i++)(t=l[i])._selected&&e.push(t[this.key]);return e},e.prototype.groupBy=function(e){var t,i,s,l,h,n;for(i={},l=0,h=(n=this.items).length;l<h;l++)null==i[t=(s=n[l])[e]]&&(i[t]=[]),i[t].push(s);return this.groups=i},e}()}});