if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,e){for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};define(["../disposable"],function(t){var e,i;return{PagingModel:e=function(t){function e(t){var i,s,n;this.options=null!=t?t:{},e.__super__.constructor.apply(this,arguments),this.predicate=null!=(i=this.options.predicate)?i:"",this.reverse=null!=(s=this.options.reverse)&&s,this.pageItems=null!=(n=this.options.pageItems)?n:12,this.page=1,this.pages=[],this.pageCount=0,this.itemCount=0,this.items=[]}return __extends(e,t),e.prototype.predicateItem=function(t){return!0},e.prototype.setItems=function(t,e){var i,s,n,r,o,p;if(s=[],t)if(t instanceof Array)for(o=0,p=t.length;o<p;o++)r=t[o],this.predicateItem(i)&&s.push(r);else for(n in t)i=t[n],this.predicateItem(i)&&s.push(i);else;return this.items=s,e?this.setPaging(e):this.processPages(),this.items},e.prototype.setPaging=function(t){var e,i,s;return this.paging=t,null!=t.page&&(this.page=t.page),null!=t.pageItems&&(this.pageItems=t.pageItems),null!=t.count&&(this.itemCount=t.count),null!=t.pageCount&&(this.pageCount=t.pageCount),0===this.pageCount?this.pages=[]:this.pages=function(){s=[];for(var t=1,e=this.pageCount;1<=e?t<=e:t>=e;1<=e?t++:t--)s.push(t);return s}.apply(this)},e.prototype.addItem=function(t){var e,i,s,n,r,o;if(t){if(t._id)for(n=0,r=(o=this.items).length;n<r;n++)if((e=o[n])._id===t._id){for(i in t)s=t[i],e[i]=s;return e}if(this.predicateItem(t))return this.items.push(t),this.processPages(),t}},e.prototype.removeItem=function(t){var e;if(t)return e=this.items.indexOf(t),this.items.splice(e,1),this.processPages(),e},e.prototype.removeById=function(t){var e,i,s,n,r;for(e=s=0,n=(r=this.items).length;s<n;e=++s)if((i=r[e])._id===t)return this.items.splice(e,1),this.processPages(),e;return-1},e.prototype.sortBy=function(t){return this.predicate===t?this.reverse=!this.reverse:(this.predicate=t,this.reverse=!0)},e.prototype.nextPage=function(){if(this.page<this.pageCount)return this.setPage(this.page+1)},e.prototype.previousPage=function(){if(this.page>1)return this.setPage(this.page-1)},e.prototype.setPage=function(t){return t<1?t=1:t>this.pageCount&&(t=this.pageCount),this.page=t,this.onPageChange(t),t},e.prototype.onPageChange=function(t){},e.prototype.processPages=function(t){var e,i,s,n;if(!this.paging&&(e=this.items.length,t||this.itemCount!==e))return this.itemCount=e,this.pageCount=Math.ceil(e/this.pageItems),0===this.pageCount?this.pages=[]:this.pages=function(){n=[];for(var t=1,e=this.pageCount;1<=e?t<=e:t>=e;1<=e?t++:t--)n.push(t);return n}.apply(this),this.page>this.pageCount?this.page=this.pageCount:this.page<1?this.page=1:void 0},e.prototype.filter=function(t,e,i){return null==e&&(e=["name"]),null==i&&(i=!0),s=this,function(n){var r,o,p;if(!t)return!0;for(o=0,p=e.length;o<p;o++)if(r=e[o],s.filterItemField(t,n,r,i))return!0;return!1};var s},e.prototype.filterItemField=function(t,e,i,s){var n,r,o;if(!(n=null!=(r=e[i])?r:null!=(o=e.model)?o[i]:void 0))return!1;if(s){if(t=t.toLowerCase(),n.toLowerCase().indexOf(t)>=0)return!0}else if(n.indexOf(t)>=0)return!0;return!1},e}(t.Disposable)}});