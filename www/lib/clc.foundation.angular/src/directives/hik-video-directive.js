if("function"!=typeof define)var define=require("amdefine")(module);define(["../models/hik-video"],function(e){var t,n;return{HikVideoDirective:t=function(t,n){return{restrict:"EA",scope:{options:"="},template:'<object classid="CLSID:CAFCF48D-8E34-4490-8154-026191D73924" standby="Loading..." class="hik-video-instance" width="100%" height="100%"></object>',link:function(i,r,o){var c,s,a;return s=null,c=function(){var t,n;if(t=null!=(n=r.find(".hik-video-instance")[0])?n.object:void 0)return(s=new e.HikVideo(i.options,t)).login()},i.$watch("options",function(e){if(e)return t(function(){return c()},100)}),i.$on("video-operation",(a=this,function(e,t){var n,r;if(s&&t.channel===i.options.channel)switch(t.type){case"start-preview":return s.startPreview(t);case"stop-preview":return s.stopPreview(t);case"start-playback":return s.startPlayback(t);case"stop-playback":return s.stopPlayback(t);case"stop-ctrl":return s.ptzCtrlstop(t);case"start-ctrl":return s.ptzCtrlstart(t);case"snap-shot":return r=0,(n=function(){++r<t.number+1&&setTimeout(function(){s.snapshot(t),n()},600)})();case"get-recordFiles":return s.getrecordFiles(t,function(e){var t,n,o,c,s;if(t=[],"null"===e)return i.$emit("file_record",t),M.toast({html:"未找到录像记录",displayLength:1500});for((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(e),n=o.documentElement.childNodes.length,r=0;r<n-1;)c=r,s=void 0,s={filename:o.documentElement.childNodes[c].childNodes[2].text,starttime:o.documentElement.childNodes[c].childNodes[3].text,stoptime:o.documentElement.childNodes[c].childNodes[4].text},t.push(s),r++;return i.$emit("file_record",t)})}})),angular.element(n).bind("resize",function(){})}}}}});