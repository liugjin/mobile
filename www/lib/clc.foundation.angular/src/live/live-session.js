if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(e,t){for(var i in t)__hasProp.call(t,i)&&(e[i]=t[i]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define(["../services/service"],function(e){var t,i;return{LiveSession:t=function(e){function t(e,i){this.liveService=e,this.options=i,t.__super__.constructor.apply(this,arguments),this.items={}}return __extends(t,e),t.prototype.subscribe=function(e,t,i,r){var o,n;return null==i&&(i=!0),o=this.liveService.subscribe(e,(n=this,function(e,i){var r,o,s,u,p;for(o in u=(r=n.getItem(i.topic)).message)s=u[o],delete r.message[o];for(o in p=i.message)s=p[o],r.message[o]=s;return"function"==typeof t?t(e,i):void 0}),i,r),this.addHandler(o)},t.prototype.getItem=function(e){var t;return(t=this.items[e])||(this.items[e]=t={topic:e,message:{}}),t},t.prototype.publish=function(e,t,i){return this.liveService.publish(e,t,i)},t.prototype.createTopic=function(e){var t,i,r,o,n,s;for(r=this.options.domain,n=0,s=(i=this.options.keys).length;n<s;n++){if(!(o=e[t=i[n]]))return r+"/#";r+="/"+o}return r},t.prototype.subscribeValues=function(e,t,i,r){var o;return o=this.createTopic(e),this.subscribe(o,t,i,r)},t}(e.Service)}});