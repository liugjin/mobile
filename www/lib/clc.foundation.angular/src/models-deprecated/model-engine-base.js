if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(e,t){for(var o in t)__hasProp.call(t,o)&&(e[o]=t[o]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};define(["../services/service"],function(e){var t,o;return{ModelEngine:t=function(e){function t(e,o,n){this.$rootScope=e,this.modelManager=o,this.storage=n,t.__super__.constructor.apply(this,arguments),this.caches={},this.options=window.setting}return __extends(t,e),t.prototype.query=function(e,t,o,n,i){var r,s,c,p,u,f;if(c=e+"&"+JSON.stringify(t)+"&"+o,r=this.caches[c],i||!r)return s=e,u=this.options.services.model+"/"+this.options.services.api+"/"+e,(p=this.modelManager.getService(s,u)).query(t,o,(f=this,function(e,t){return f.caches[c]=t,"function"==typeof n?n(e,t):void 0}),i);"function"==typeof n&&n(null,r)},t}(e.Service)}});