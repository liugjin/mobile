if("function"!=typeof define)var define=require("amdefine")(module);var __hasProp={}.hasOwnProperty,__extends=function(t,e){for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};define(["../view-model","../items-model","./equipment-templates","./stations"],function(t,e,o,s){var i,n;return{Project:i=function(t){function i(t,e){i.__super__.constructor.call(this,t,e),this.equipmentTemplates=new o.EquipmentTemplates(this),this.stations=new s.Stations(this),this.equipments={},this.signals={},this.signalTopics={},this.signalTopics2={},this.events={},this.eventTopics={},this.commands={},this.commandTopics={},this.loadModels()}return __extends(i,t),i.prototype.loadModels=function(){var t,e,o,s;for(e=[{model:"datatypes",key:"type"},{model:"stationtypes",key:"type"},{model:"signaltypes",key:"type"},{model:"eventtypes",key:"type"},{model:"eventseverities",key:"severity"},{model:"units",key:"unit"},{model:"vendors",key:"vendor"},{model:"equipmenttypes",key:"type"},{model:"capacities",key:"capacity"},{model:"eventphases",key:"phase"},{model:"porttypes",key:"type"}],this.dictionary=this.typeModels={},o=0,s=e.length;o<s;o++)t=e[o],this.createTypeModel(t.model,t.key);return this.dictionary},i.prototype.getIds=function(){var t;return{user:this.model.user,project:this.model.project}},i.prototype.createTypeModel=function(t,o){var s;return s=new e.ItemsModel(this,{id:t,keys:[o]}),this.typeModels[t]=s,s},i.prototype.loadTypeModel=function(t,e,o,s){var i,n;if(n=this.typeModels[t])return i={user:this.model.user,project:this.model.project},n.load(i,e,o,s);"function"==typeof o&&o("unknown type: "+t)},i.prototype.loadTypeModels=function(t,e){var o,s,i,n;for(s in o={user:this.model.user,project:this.model.project},n=this.typeModels)(i=n[s]).load(o,null,t,e)},i.prototype.getTypeProperty=function(t,e,o){var s,i;return null!=(s=this.typeModels[t])&&null!=(i=s.getItem(e))?i.model[o]:void 0},i.prototype.loadStations=function(t,e,o){var s;return s={user:this.model.user,project:this.model.project},this.stations.load(s,t,e,o)},i.prototype.loadEquipmentTemplates=function(t,e,o,s){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),this.equipmentTemplates.load(t,e,o,s)},i.prototype.loadEquipmentTemplate=function(t,e,o,s){return null==t&&(t={}),null==t.user&&(t.user=this.model.user),null==t.project&&(t.project=this.model.project),this.equipmentTemplates.loadEquipmentTemplate(t,e,o,s)},i.prototype.dispose=function(){var t,e,o,s,n,r,p,l,a,u,d;for(o in i.__super__.dispose.apply(this,arguments),p=this.typeModels)(r=p[o]).dispose();for(s in this.equipmentTemplates.dispose(),this.stations.dispose(),l=this.signals)n=l[s],delete this.signals[s];for(s in a=this.events)e=a[s],delete this.events[s];for(s in d=[],u=this.commands)t=u[s],d.push(delete this.commands[s]);return d},i.prototype.addSignal=function(t){var e,o,s;return o="signal-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.signal,this.signalTopics[o]=t,s="signal-statistics/"+e.user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.signal,this.signalTopics2[s]=t,this.signals[t.key]=t,t},i.prototype.getSignal=function(t){return this.signals[t]},i.prototype.getSignalByTopic=function(t){return this.signalTopics[t]},i.prototype.getSignalByTopic2=function(t){return this.signalTopics2[t]},i.prototype.addEvent=function(t){var e,o;return o="event-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.event,this.eventTopics[o]=t,this.events[t.key]=t,t},i.prototype.getEvent=function(t){return this.events[t]},i.prototype.getEventByTopic=function(t){return this.eventTopics[t]},i.prototype.addCommand=function(t){var e,o;return o="command-values/"+(e=t.equipment.model).user+"/"+e.project+"/"+e.station+"/"+e.equipment+"/"+t.model.command,this.commandTopics[o]=t,this.commands[t.key]=t,t},i.prototype.getCommand=function(t){return this.commands[t]},i.prototype.getCommandByTopic=function(t){return this.commandTopics[t]},i.prototype.createStation=function(t){var e;return e={user:this.model.user,project:this.model.project,parent:null!=t?t.model.station:void 0},this.station=this.stations.createItem(e),this.station.parentStation=t,this.station.root=this,this.station},i}(t.ViewModel)}});